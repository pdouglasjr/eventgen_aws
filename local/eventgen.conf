##########
# Config #
##########
[aws_*\.events]
host = aio1
index = aws

[aws_config*\.events]
interval = 3600
earliest = -60m
latest = now
maxIntervalsBeforeFlush = 1

## Replace timestamp "2013-11-21T00:11:46Z"
## Ignoring timezone because python's %Z has... issues
## You'll take GMT and like it.
token.0.token = "(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}).\d{3}Z"
token.0.replacementType = timestamp
token.0.replacement = %Y-%m-%dT%H:%M:%S

## Replace XXXXXXXX with the resource ID
## 00000000 seems also OK...
token.1.token = XXXXXXXX
token.1.replacementType = static
token.1.replacement = 00000000

## Replace IDIDIDID with the event ID
token.2.token = IDIDIDID
token.2.replacementType = integerid
token.2.replacement = 1

[aws_config.events]
sourcetype = aws:config

[aws_config_notification.events]
sourcetype = aws:config:notification

token.0.token = <#publicIP#>
token.0.replacementType = file
token.0.replacement = $SPLUNK_HOME/etc/apps/eventgen_aws/samples/aws_ip.sample

[aws_cloudtrail*\.events]
interval = 3600
earliest = -60m
latest = now
maxIntervalsBeforeFlush = 1

sourcetype = aws:cloudtrail

## Replace timestamp "eventTime": "2013-11-21T00:11:46Z"
## Ignoring timezone because python's %Z has... issues
## You'll take GMT and like it.
token.0.token = "eventTime":\s"(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})Z"
token.0.replacementType = timestamp
token.0.replacement = %Y-%m-%dT%H:%M:%S

## Replace AAAAAAAAAA with the key
token.1.token = AAAAAAAAAA
token.1.replacementType = file
token.1.replacement = $SPLUNK_HOME/etc/apps/eventgen_aws/samples/aws_key.sample

## Replace BBBBBBBBBB with random principal IDs
token.2.token = BBBBBBBBBB
token.2.replacementType = file
token.2.replacement = $SPLUNK_HOME/etc/apps/eventgen_aws/samples/aws_pid.sample

## Replace CCCCCCCCCC with random IDs
token.3.token = CCCCCCCCCC
token.3.replacementType = file
token.3.replacement = $SPLUNK_HOME/etc/apps/eventgen_aws/samples/aws_id.sample

## Replace DDDDDDDDDD with random amazon addresses
token.4.token = DDDDDDDDDD
token.4.replacementType = file
token.4.replacement = $SPLUNK_HOME/etc/apps/eventgen_aws/samples/aws_ip.sample

## Replace EEEEEEEEEE with random amazon users
token.5.token = EEEEEEEEEE
token.5.replacementType = file
token.5.replacement = $SPLUNK_HOME/etc/apps/eventgen_aws/samples/aws_users.sample

## Replace FFFFFFFFFF with secondary random amazon users
token.6.token = FFFFFFFFFF
token.6.replacementType = file
token.6.replacement = $SPLUNK_HOME/etc/apps/eventgen_aws/samples/aws_users.sample

## Replace GGGGGGGGGG with random malicious users
token.7.token = GGGGGGGGGG
token.7.replacementType = file
token.7.replacement = $SPLUNK_HOME/etc/apps/eventgen_aws/samples/aws_malicious_users.sample

## Replace HHHHHHHHHH with random amazon server roles
token.8.token = HHHHHHHHHH
token.8.replacementType = file
token.8.replacement = $SPLUNK_HOME/etc/apps/eventgen_aws/samples/aws_server_roles.sample

## Replace <responseElements.ConsoleLogin>
token.9.token = <responseElements.ConsoleLogin>
token.9.replacementType = random
token.9.replacement = list["Success", "Failure"]

## Replace <sourceIPAddress>
token.10.token = <sourceIPAddress>
token.10.replacementType = random
token.10.replacement = list["192.168.1.1", "192.168.1.2", "192.168.1.3", "192.168.1.4", "192.168.1.5"]

## Replace <userIdentity.type>
token.11.token = <userIdentity.type>
token.11.replacementType = random
token.11.replacement = list["Root", "IAMUser", "AssumedRole", "FederatedUser"]
